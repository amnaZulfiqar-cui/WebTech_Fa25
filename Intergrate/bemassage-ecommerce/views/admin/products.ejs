<%- include('../layouts/admin', { title: 'Manage Products', currentPage:
'products' }) %> <% contentFor('body') %>
<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h3 mb-0">Manage Products</h1>
    <a href="/admin/products/add" class="btn-admin btn-admin-success">
      <i class="fas fa-plus me-1"></i> Add New Product
    </a>
  </div>

  <!-- Products Table -->
  <div class="card">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th>ID</th>
              <th>Image</th>
              <th>Name</th>
              <th>Price</th>
              <th>Category</th>
              <th>Duration</th>
              <th>Featured</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% if (products && products.length > 0) { %> <%
            products.forEach(product => { %>
            <tr>
              <td><%= product._id.toString().substring(18) %></td>
              <td>
                <img
                  src="/images/<%= product.image %>"
                  alt="<%= product.name %>"
                  style="
                    width: 50px;
                    height: 50px;
                    object-fit: cover;
                    border-radius: 5px;
                  "
                />
              </td>
              <td><%= product.name %></td>
              <td>$<%= product.price %></td>
              <td>
                <span class="badge bg-secondary"><%= product.category %></span>
              </td>
              <td><%= product.duration %> min</td>
              <td>
                <% if (product.featured) { %>
                <span class="badge bg-success">Yes</span>
                <% } else { %>
                <span class="badge bg-secondary">No</span>
                <% } %>
              </td>
              <td>
                <div class="btn-group" role="group">
                  <a
                    href="/admin/products/edit/<%= product._id %>"
                    class="btn-admin btn-sm me-1"
                    title="Edit"
                  >
                    <i class="fas fa-edit"></i>
                  </a>
                  <form
                    action="/admin/products/delete/<%= product._id %>"
                    method="POST"
                    class="d-inline"
                    onsubmit="return confirm('Are you sure you want to delete this product?')"
                  >
                    <button
                      type="submit"
                      class="btn-admin btn-admin-danger btn-sm"
                      title="Delete"
                    >
                      <i class="fas fa-trash"></i>
                    </button>
                  </form>
                </div>
              </td>
            </tr>
            <% }); %> <% } else { %>
            <tr>
              <td colspan="8" class="text-center py-4">
                <div class="text-muted">
                  <i class="fas fa-box-open fa-2x mb-3"></i>
                  <p>No products found. Add your first product!</p>
                  <a href="/admin/products/add" class="btn-admin">
                    <i class="fas fa-plus me-1"></i> Add Product
                  </a>
                </div>
              </td>
            </tr>
            <% } %>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <% if (totalPages > 1) { %>
      <nav aria-label="Page navigation" class="mt-4">
        <ul class="pagination justify-content-center">
          <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
            <a class="page-link" href="?page=<%= currentPage - 1 %>"
              >Previous</a
            >
          </li>

          <% for (let i = 1; i <= totalPages; i++) { %>
          <li class="page-item <%= currentPage === i ? 'active' : '' %>">
            <a class="page-link" href="?page=<%= i %>"><%= i %></a>
          </li>
          <% } %>

          <li
            class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>"
          >
            <a class="page-link" href="?page=<%= currentPage + 1 %>">Next</a>
          </li>
        </ul>
      </nav>
      <% } %>
    </div>
  </div>
</div>
<% end %>
